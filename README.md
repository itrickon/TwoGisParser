# TwoGIS Parser

Парсер данных с платформы 2GIS для сбора информации о предприятиях: URL, номера телефонов, сайтов и другой контактной информации.

## Возможности

- **Два режима парсинга**: по ключевому слову и городу или по прямой ссылке на страницу 2GIS
- **Извлечение данных**: URL компании, название, категория, телефон, сайт
- **Экспорт в Excel**: автоматическое сохранение результатов в формате XLSX
- **Графический интерфейс**: интуитивно понятное приложение с поддержкой темной и светлой темы
- **Асинхронная обработка**: высокая производительность без блокировки интерфейса

## Требования

- Python 3.11 или выше
- Подключение к интернету
- Учетная запись для доступа к 2GIS (при необходимости)

## Установка

### Способ 1: Запуск через Python

1. Клонируйте репозиторий или скачайте исходный код
2. Установите зависимости:

- pip install playwright openpyxl googletrans sv-ttk asyncio
- playwright install chromium
- Откройте файл MainTwoGis.py

### В функции main() настройте параметры:

- **keyword**: ключевое слово для поиска
- **sity**: город для парсинга
- **max_num_firm**: количество компаний для обработки

### -Запустите файл-

### Способ 2: Графический интерфейс

- Запустите файл **gui_main.py**
- В открывшемся приложении **TwoGisParser**:
- Введите ключевое слово и город в "**Параметры парсинга**"
- Укажите количество фирм в "**Дополнительных параметрах**"
- Нажмите "**Запустить парсинг**"

При необходимости используйте режим "Парсинг по URL" для работы с прямыми ссылками формата:

* https://2gis.ru/moscow/search/Рестораны

### Способ 3: Исполняемый файл

- Запустите **twogispars.bat**
- Дождитесь установки зависимостей и сборки EXE-файла
- Откройте **dist/TwoGisParser.exe**
- Используйте графический интерфейс как описано в **способе 2**

### Использование
#### Парсер по ключу

- Выберите режим "Парсер по ключу"
- Введите ключевое слово (например, "Рестораны")
- Укажите город (например, "Москва")
- Задайте количество компаний для обработки
- Нажмите "Запустить парсинг"

#### Парсер по URL
- Выберите режим "Парсер по URL"
- Вставьте ссылку на страницу поиска 2GIS
- Укажите количество компаний для обработки
- Нажмите "Запустить парсинг"

### Выходные данные

Результаты сохраняются в файл 2gis_parse_results/data.xlsx со следующими колонками:

Колонка	Описание
URL -	Ссылка на страницу компании
Название -	Название предприятия
Категория -	Категория деятельности
Телефон -	Контактный телефон
Сайт -	Веб-сайт компании

### Особенности работы

- Случайные задержки: для имитации человеческого поведения
- Ротация User-Agent: обход ограничений на автоматизацию
- Обработка ошибок: устойчивость к временным сбоям сети
- Логирование: подробный журнал выполнения операций

### Безопасность и соблюдение правил

**Данный инструмент предназначен для сбора открытой информации в образовательных и исследовательских целях.** 

### Рекомендуется:

- Ознакомиться с условиями использования 2GIS
- Устанавливать разумные лимиты на количество запросов
- Использовать инструмент ответственно и в соответствии с законодательством

## Устранение неполадок
#### Если парсер не работает:

- Проверьте подключение к интернету
- Убедитесь, что установлены все зависимости
- Проверьте корректность введенных параметров

Для режима по ключу: используйте режим по URL с предварительно сгенерированной ссылкой

### Поддержка
#### При возникновении проблем создавайте issue в репозитории проекта. Указывайте:

- Описание проблемы
- Шаги для воспроизведения
- Скриншоты или логи ошибок
- Версию Python и установленные пакеты